

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>osh-backup-acl-keys.conf reference &mdash; The Bastion 3.04.00 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/thebastion.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="osh-piv-grace-reaper.conf reference" href="osh-piv-grace-reaper_conf.html" />
    <link rel="prev" title="osh-encrypt-rsync.conf reference" href="osh-encrypt-rsync_conf.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Bastion
          

          
          </a>

          
            
            
              <div class="version">
                3.04.00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../presentation/index.html">Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation &amp; Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using/index.html">Using the bastion</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Administration</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Configuration files</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="bastion_conf.html">bastion.conf reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="osh-http-proxy_conf.html">osh-http-proxy.conf reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="osh-encrypt-rsync_conf.html">osh-encrypt-rsync.conf reference</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">osh-backup-acl-keys.conf reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#option-list">Option List</a></li>
<li class="toctree-l4"><a class="reference internal" href="#option-reference">Option Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="osh-piv-grace-reaper_conf.html">osh-piv-grace-reaper.conf reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="osh-sync-watcher_sh.html">osh-sync-watcher.sh reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../logs.html">Logs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/index.html">Bastion plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Bastion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Administration</a> &raquo;</li>
        
          <li><a href="index.html">Configuration files</a> &raquo;</li>
        
      <li>osh-backup-acl-keys.conf reference</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/administration/configuration/osh-backup-acl-keys_conf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="osh-backup-acl-keys-conf-reference">
<h1>osh-backup-acl-keys.conf reference<a class="headerlink" href="#osh-backup-acl-keys-conf-reference" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The osh-backup-acl-keys script is called by cron and is responsible for backing up
the bastion configuration, users &amp; groups lists, credentials, and everything needed
to be able to restore a functioning bastion from scratch.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If left unconfigured, this script won't do anything, and you won't have backups,
unless this task is handled by some other external system.</p>
</div>
<div class="section" id="option-list">
<h2>Option List<a class="headerlink" href="#option-list" title="Permalink to this headline">¶</a></h2>
<div class="section" id="logging-options">
<h3>Logging options<a class="headerlink" href="#logging-options" title="Permalink to this headline">¶</a></h3>
<p>These options configure the way the script logs its actions</p>
<ul class="simple">
<li><a class="reference internal" href="#logfile">LOGFILE</a></li>
<li><a class="reference internal" href="#log-facility">LOG_FACILITY</a></li>
</ul>
</div>
<div class="section" id="backup-policy-options">
<h3>Backup policy options<a class="headerlink" href="#backup-policy-options" title="Permalink to this headline">¶</a></h3>
<p>These options configure the backup policy to apply</p>
<ul class="simple">
<li><a class="reference internal" href="#destdir">DESTDIR</a></li>
<li><a class="reference internal" href="#daystokeep">DAYSTOKEEP</a></li>
<li><a class="reference internal" href="#gpgkeys">GPGKEYS</a></li>
</ul>
</div>
<div class="section" id="remote-backup-options">
<h3>Remote backup options<a class="headerlink" href="#remote-backup-options" title="Permalink to this headline">¶</a></h3>
<p>These options configure how the script should push the encrypted backups to a remote system</p>
<ul class="simple">
<li><a class="reference internal" href="#push-remote">PUSH_REMOTE</a></li>
<li><a class="reference internal" href="#push-options">PUSH_OPTIONS</a></li>
</ul>
</div>
</div>
<div class="section" id="option-reference">
<h2>Option Reference<a class="headerlink" href="#option-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="logging">
<h3>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<div class="section" id="logfile">
<h4>LOGFILE<a class="headerlink" href="#logfile" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">string,</span> <span class="pre">path</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">file</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></td>
</tr>
</tbody>
</table>
<p>File where the logs will be written to (don't forget to configure <code class="docutils literal notranslate"><span class="pre">logrotate</span></code>!). Note that using this configuration option, the script will directly write to the file, without using syslog. If empty, won't log directly to any file.</p>
</div>
<div class="section" id="log-facility">
<h4>LOG_FACILITY<a class="headerlink" href="#log-facility" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">&quot;local6&quot;</span></code></td>
</tr>
</tbody>
</table>
<p>The syslog facility to use for logging the script output. If set to the empty string, we'll not log through syslog at all. If this configuration option is missing from your config file altogether, the default value will be used (local6), which means that we'll log to syslog.</p>
</div>
</div>
<div class="section" id="backup-policy">
<h3>Backup policy<a class="headerlink" href="#backup-policy" title="Permalink to this headline">¶</a></h3>
<div class="section" id="destdir">
<h4>DESTDIR<a class="headerlink" href="#destdir" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">folder</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">&quot;/root/backups&quot;</span></code></td>
</tr>
</tbody>
</table>
<p>Folder where to put the backup artefacts (<code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code> files). This folder will be created if needed. If empty or omitted, the script won't run: this option is mandatory.</p>
</div>
<div class="section" id="daystokeep">
<h4>DAYSTOKEEP<a class="headerlink" href="#daystokeep" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">&gt;</span> <span class="pre">0</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">90</span></code></td>
</tr>
</tbody>
</table>
<p>Number of days to keep the old backups on the filesystem before deleting them.</p>
</div>
<div class="section" id="gpgkeys">
<h4>GPGKEYS<a class="headerlink" href="#gpgkeys" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">string,</span> <span class="pre">space-separated</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">GPG</span> <span class="pre">keys</span> <span class="pre">IDs</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">&quot;41FDB9C7</span> <span class="pre">DA97EFD1</span> <span class="pre">339483FF&quot;</span></code></td>
</tr>
</tbody>
</table>
<p>List of public GPG keys to encrypt to (see <code class="docutils literal notranslate"><span class="pre">gpg</span> <span class="pre">--list-keys</span></code>), these must be separated by spaces. Note that if this option is empty or omitted, backup artefacts will NOT be encrypted!</p>
</div>
</div>
<div class="section" id="remote-backup">
<h3>Remote backup<a class="headerlink" href="#remote-backup" title="Permalink to this headline">¶</a></h3>
<div class="section" id="push-remote">
<h4>PUSH_REMOTE<a class="headerlink" href="#push-remote" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">&quot;push&#64;1.2.3.4:~/backup/&quot;</span></code></td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">scp</span></code> remote host push backups to. If empty or missing, won't push backups. This will also be the case if the <code class="docutils literal notranslate"><span class="pre">GPGKEYS</span></code> option above is empty or missing, because we will never push unencrypted backups. Don't forget to put a trailing <code class="docutils literal notranslate"><span class="pre">/</span></code> (except if you want to push to the remote <code class="docutils literal notranslate"><span class="pre">$HOME</span></code>, in which case ending with a simple <code class="docutils literal notranslate"><span class="pre">:</span></code> works, as per standard <code class="docutils literal notranslate"><span class="pre">scp</span></code>).</p>
</div>
<div class="section" id="push-options">
<h4>PUSH_OPTIONS<a class="headerlink" href="#push-options" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Default:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">&quot;-i</span> <span class="pre">$HOME/.ssh/id_backup&quot;</span></code></td>
</tr>
</tbody>
</table>
<p>Additional options to pass to <code class="docutils literal notranslate"><span class="pre">scp</span></code>, if needed.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="osh-piv-grace-reaper_conf.html" class="btn btn-neutral float-right" title="osh-piv-grace-reaper.conf reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="osh-encrypt-rsync_conf.html" class="btn btn-neutral float-left" title="osh-encrypt-rsync.conf reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, OVHcloud

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>